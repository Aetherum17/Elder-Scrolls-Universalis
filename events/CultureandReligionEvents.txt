##########################################################################
# Events for Culture and Religion for Rulers, Heirs, Consorts and Advisors
#
# written by Henrik Lohmander
##########################################################################

namespace = culture_religion_events

# [Root.Heir.GetName] and the [Root.given_teacher_culture.GetCultureName] people
country_event = {
	id = culture_religion_events.1
	title = "culture_religion_events.1.t"
	desc = "culture_religion_events.1.d"
	picture = {
		trigger = { NOT = { has_dlc = "Cradle of Civilization" } }
		picture = INVENTION_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Cradle of Civilization" }
		picture = HEIR_AND_FOREIGN_ADVISOR_eventPicture
	}
	
	trigger = {
		has_heir = yes
		has_regency = no
		has_consort_regency = no
		NOT = { has_reform = elective_monarchy }
		heir_age = 13
		NOT = { heir_age = 25 }
		employed_advisor = {
			category = ADM
		}
		any_owned_province = {
			NOT = {
				owner = {
					employed_advisor = {
						category = ADM
						culture = PREV
					}
				}
			}
		}
		variable_arithmetic_trigger = {
			export_to_variable = {
				variable_name = cultural_heir_culture
				value = heir_culture
			}
			export_to_variable = {
				variable_name = teacher_culture
				value = adm_advisor_culture
			}
			export_to_variable = {
				variable_name = parent_culture
				value = ruler_culture
			}
			NOT = {
				variable_arithmetic_trigger = {
					is_variable_equal = {
						which = cultural_heir_culture
						which = teacher_culture
					}
				}
			}
			is_variable_equal = {
				which = cultural_heir_culture
				which = parent_culture
			}
		}
	}

	immediate = {
		hidden_effect = {
			export_to_variable = {
				variable_name = given_teacher_culture
				value = adm_advisor_culture
			}
			set_saved_name = {
				key = capital_noble
				type = advisor
				scope = ROOT
			}
		}
	}
	
	mean_time_to_happen = {
		months = 800
		modifier = {
			factor = 0.8
			heir_has_personality = well_connected_personality
		}
		modifier = {
			factor = 0.8
			heir_has_personality = free_thinker_personality
		}
		modifier = {
			factor = 0.8
			heir_has_personality = tolerant_personality
		}
		modifier = {
			factor = 0.8
			heir_has_personality = babbling_buffoon_personality
		}
		modifier = {
			factor = 0.8
			heir_has_personality = naive_personality
		}
		modifier = {
			factor = 0.8
			heir_has_personality = loose_lips_personality
		}
		modifier = {
			factor = 1.2
			heir_has_personality = careful_personality
		}
		modifier = {
			factor = 1.2
			heir_has_personality = zealot_personality
		}
		modifier = {
			factor = 1.2
			heir_has_personality = malevolent_personality
		}
	}

	option = {
		name = "culture_religion_events.1.a" #
		remove_advisor_by_category = ADM
		add_adm_power = -50
		define_advisor = {
			name = capital_noble
			type = statesman
			skill = 2
			discount = yes
		}
	}
	option = {
		name = "culture_religion_events.1.b" #
		set_heir_culture = variable:given_teacher_culture
		add_heir_claim = -25
		custom_tooltip = culture_religion_events.1.b.tt
		hidden_effect = {
			every_owned_province = {
				limit = {
					culture = variable:FROM:given_teacher_culture
				}
				add_province_modifier = {
					name = "heir_is_our_heir"
					duration = 3650
				}
			}
		}
	}
	
	after = {
		clear_saved_name = capital_noble
		hidden_effect = {
			set_variable = {
				which = given_teacher_culture
				value = -1
			}
		}
	}
}

# Triggers within a few years of succession.
country_event = {
	id = culture_religion_events.2
	title = "culture_religion_events.2.t"
	picture = {
		trigger = {
			has_regency = yes
		}
		picture = DEBATE_REPUBLICAN_eventPicture
	}
	picture = {
		trigger = {
			has_regency = no
			NOT = { has_dlc = "Cradle of Civilization" }
		}
		picture = ACCUSATION_eventPicture
	}
	picture = {
		trigger = {
			has_regency = no
			has_dlc = "Cradle of Civilization"
		}
		picture = KING_OF_FOREIGN_CUSTOMS_eventPicture
	}
	
	desc = {
		desc = "culture_religion_events.2.da" #Different Culture - But we have subjects of it
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			NOT = { ruler_culture = ROOT }
			ruler_religion = ROOT
			any_owned_province = {
				culture = variable:From:new_ruler_culture
			}
		}
	}
	desc = {
		desc = "culture_religion_events.2.db" #Different Culture - And we have no subjects of it
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			NOT = { ruler_culture = ROOT }
			ruler_religion = ROOT
			NOT = {
				any_owned_province = {
					culture = variable:From:new_ruler_culture
				}
			}
		}
	}
	desc = {
		desc = "culture_religion_events.2.dc" #Different Heathen Religion
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			ruler_culture = ROOT
			NOT = { ruler_religion = ROOT }
			NOT = { religion_group = variable:new_ruler_religion }
		}
	}
	desc = {
		desc = "culture_religion_events.2.dda" #Different Heretic Religion
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			ruler_culture = ROOT
			NOT = { ruler_religion = ROOT }
			religion_group = variable:new_ruler_religion
		}
	}
	
	desc = {
		desc = "culture_religion_events.2.de" #Different Culture and Different Religion
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			NOT = { ruler_culture = ROOT }
			NOT = { ruler_religion = ROOT }
		}
	}
	
	desc = {
		desc = "culture_religion_events.2.df" #What's this then? Well the event triggers with a delay from the day of succession.It is possible for someone to usurp the throne before this event happens or for other triggers to no longer be true.
		trigger = {
			OR = {
				has_regency = yes #It is also possible to enter a regency
				has_reform = mamluk_government #It is even possible to suddenly get the Mamluk Government form.
				AND = {
					ruler_culture = ROOT
					ruler_religion = ROOT
				}
			}
		}
	}
	
	is_triggered_only = yes #Triggers in on_action for new ruler.
	
	immediate = {
		hidden_effect = {
			clr_country_flag = had_culture_religion_reaction_event_flag
			random_list = {
				15 = { set_country_flag = strong_effect } #Harsh Reception
				35 = { set_country_flag = medium_effect } #Average Reception
				50 = { set_country_flag = small_effect }  #Mild Reception
			}
			export_to_variable = {
				variable_name = new_ruler_culture
				value = ruler_culture
			}
			export_to_variable = {
				variable_name = new_ruler_religion
				value = ruler_religion
			}
			set_saved_name = { #Not actually used as a preacher in all event versions
				key = rebel_preacher
				type = advisor
				scope = ROOT
			}
		}
	}

	option = {
		name = "culture_religion_events.2.a" #Different Culture
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			NOT = { ruler_culture = ROOT }
			ruler_religion = ROOT
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						primary_culture = variable:From:new_ruler_culture
					}
					amount = 8
				}
			}
			custom_tooltip  = culture_opinion_tooltip
			hidden_effect = {
				every_known_country = {
					limit = {
						primary_culture = variable:From:new_ruler_culture
					}
					add_opinion = {
						modifier = opinion_ruler_of_our_culture
						who = ROOT
					}
				}
			}
		}
		else = {
			every_known_country = {
				limit = {
					primary_culture = variable:From:new_ruler_culture
				}
				add_opinion = {
					modifier = opinion_ruler_of_our_culture
					who = ROOT
				}
			}
		}
		trigger_switch = {
			on_trigger = has_country_flag
			medium_effect = {
				custom_tooltip = culture_religion_events.2.a.ttm1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_culture = yes
						}
						add_province_modifier = {
							name = "foreigner_on_throne"
							duration = 1825
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							culture = variable:FROM:new_ruler_culture
						}
					}
					custom_tooltip = culture_religion_events.2.a.ttm2
					hidden_effect = {
						every_owned_province = {
							limit = {
								culture = variable:FROM:new_ruler_culture
							}
							add_province_modifier = {
								name = "support_for_ruler"
								duration = 1825
							}
						}
					}
				}
				else_if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = recruitmaster
						skill = 3
						discount = yes
						culture = variable:new_ruler_culture
					}
				}
				else = {
					define_advisor = {
						type = recruitmaster
						skill = 2
						discount = yes
						culture = variable:new_ruler_culture
					}
				}
				clr_country_flag = medium_effect
			}
			small_effect = {
				custom_tooltip = culture_religion_events.2.a.tts1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_culture = yes
						}
						add_province_modifier = {
							name = "foreigner_on_throne"
							duration = 1095
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							culture = variable:FROM:new_ruler_culture
						}
					}
					custom_tooltip = culture_religion_events.2.a.tts2
					hidden_effect = {
						every_owned_province = {
							limit = {
								culture = variable:FROM:new_ruler_culture
							}
							add_province_modifier = {
								name = "support_for_ruler"
								duration = 1095
							}
						}
					}
				}
				else_if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = recruitmaster
						skill = 2
						discount = yes
						culture = variable:new_ruler_culture
					}
				}
				else = {
					define_advisor = {
						type = recruitmaster
						skill = 1
						discount = yes
						culture = variable:new_ruler_culture
					}
				}
				clr_country_flag = small_effect
			}
			strong_effect = {
				custom_tooltip = culture_religion_events.2.a.ttl1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_culture = yes
						}
						add_province_modifier = {
							name = "foreigner_on_throne"
							duration = 2555
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							culture = variable:FROM:new_ruler_culture
						}
					}
					custom_tooltip = culture_religion_events.2.a.ttl2
					hidden_effect = {
						every_owned_province = {
							limit = {
								culture = variable:FROM:new_ruler_culture
							}
							add_province_modifier = {
								name = "support_for_ruler"
								duration = 2555
							}
						}
					}
				}
				else_if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = grand_captain
						skill = 3
						discount = yes
						culture = variable:new_ruler_culture
					}
				}
				else = {
					define_advisor = {
						type = grand_captain
						skill = 2
						discount = yes
						culture = variable:new_ruler_culture
					}
				}
				clr_country_flag = strong_effect
			}
		}
	}
	option = {
		name = "culture_religion_events.2.b" #Different Heathen Religion - This is harder to get.
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			ruler_culture = ROOT
			NOT = { ruler_religion = ROOT }
			NOT = { religion_group = variable:new_ruler_religion }
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						religion = variable:From:new_ruler_religion
					}
					amount = 8
				}
			}
			custom_tooltip  = religion_opinion_tooltip
			hidden_effect = {
				every_known_country = {
					limit = {
						religion = variable:From:new_ruler_religion
					}
					add_opinion = {
						modifier = opinion_ruler_of_our_religion
						who = ROOT
					}
				}
			}
		}
		else = {
			every_known_country = {
				limit = {
					religion = variable:From:new_ruler_religion
				}
				add_opinion = {
					modifier = opinion_ruler_of_our_religion
					who = ROOT
				}
			}
		}
		trigger_switch = {
			on_trigger = has_country_flag
			medium_effect = {
				if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = theologian
						skill = 3
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				else = {
					define_advisor = {
						type = theologian
						skill = 2
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				custom_tooltip = culture_religion_events.2.b.ttm1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_religion = yes
						}
						add_province_modifier = {
							name = "heathen_on_throne"
							duration = 2555
						}
					}
				}
				random_owned_province = {
					limit = {
						has_owner_religion = yes
					}
					spawn_rebels = {
						type = religious_rebels
						size = 1
						leader = rebel_preacher
					}
				}
				if = {
					limit = {
						any_owned_province = {
							religion = variable:FROM:new_ruler_religion
						}
					}
					custom_tooltip = culture_religion_events.2.b.ttm2
					hidden_effect = {
						every_owned_province = {
							limit = {
								religion = variable:FROM:new_ruler_religion
							}
							add_province_modifier = {
								name = "support_for_heathen_ruler"
								duration = 2555
							}
						}
					}
				}
				clr_country_flag = medium_effect
			}
			small_effect = {
				if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = theologian
						skill = 3
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				else = {
					define_advisor = {
						type = theologian
						skill = 2
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				random_owned_province = {
					limit = {
						has_owner_religion = yes
					}
					spawn_rebels = {
						type = religious_rebels
						size = 1
						leader = rebel_preacher
					}
				}
				custom_tooltip = culture_religion_events.2.b.tts1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_religion = yes
						}
						add_province_modifier = {
							name = "heathen_on_throne"
							duration = 1825
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							religion = variable:FROM:new_ruler_religion
						}
					}
					custom_tooltip = culture_religion_events.2.b.tts2
					hidden_effect = {
						every_owned_province = {
							limit = {
								religion = variable:FROM:new_ruler_religion
							}
							add_province_modifier = {
								name = "support_for_heathen_ruler"
								duration = 1825
							}
						}
					}
				}
				clr_country_flag = small_effect
			}
			strong_effect = {
				if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = theologian
						skill = 2
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				else = {
					define_advisor = {
						type = theologian
						skill = 1
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				random_owned_province = {
					limit = {
						has_owner_religion = yes
					}
					spawn_rebels = {
						type = religious_rebels
						size = 2
						leader = rebel_preacher
					}
				}
				custom_tooltip = culture_religion_events.2.b.ttl1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_religion = yes
						}
						add_province_modifier = {
							name = "heathen_on_throne"
							duration = 3650
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							religion = variable:FROM:new_ruler_religion
						}
					}
					custom_tooltip = culture_religion_events.2.b.ttl2
					hidden_effect = {
						every_owned_province = {
							limit = {
								religion = variable:FROM:new_ruler_religion
							}
							add_province_modifier = {
								name = "support_for_heathen_ruler"
								duration = 3650
							}
						}
					}
				}
				clr_country_flag = strong_effect
			}
		}
	}
	option = {
		name = "culture_religion_events.2.c" #Different Heretic Religion - This is harder to get (but not as hard as heathen).
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			ruler_culture = ROOT
			NOT = { ruler_religion = ROOT }
			religion_group = variable:new_ruler_religion
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						religion = variable:From:new_ruler_religion
					}
					amount = 8
				}
			}
			custom_tooltip  = religion_opinion_tooltip
			hidden_effect = {
				every_known_country = {
					limit = {
						religion = variable:From:new_ruler_religion
					}
					add_opinion = {
						modifier = opinion_ruler_of_our_religion
						who = ROOT
					}
				}
			}
		}
		else = {
			every_known_country = {
				limit = {
					religion = variable:From:new_ruler_religion
				}
				add_opinion = {
					modifier = opinion_ruler_of_our_religion
					who = ROOT
				}
			}
		}
		trigger_switch = {
			on_trigger = has_country_flag
			medium_effect = {
				if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = theologian
						skill = 3
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				else = {
					define_advisor = {
						type = theologian
						skill = 2
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				custom_tooltip = culture_religion_events.2.c.ttm1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_religion = yes
						}
						add_province_modifier = {
							name = "heretic_on_throne"
							duration = 2555
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							religion = variable:FROM:new_ruler_religion
						}
					}
					custom_tooltip = culture_religion_events.2.c.ttm2
					hidden_effect = {
						every_owned_province = {
							limit = {
								religion = variable:FROM:new_ruler_religion
							}
							add_province_modifier = {
								name = "support_for_heretic_ruler"
								duration = 2555
							}
						}
					}
				}
				clr_country_flag = medium_effect
			}
			small_effect = {
				if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = theologian
						skill = 3
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				else = {
					define_advisor = {
						type = theologian
						skill = 2
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				custom_tooltip = culture_religion_events.2.c.tts1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_religion = yes
						}
						add_province_modifier = {
							name = "heretic_on_throne"
							duration = 1825
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							religion = variable:FROM:new_ruler_religion
						}
					}
					every_owned_province = {
						limit = {
							religion = variable:FROM:new_ruler_religion
						}
						custom_tooltip = culture_religion_events.2.c.tts2
						hidden_effect = {
							add_province_modifier = {
								name = "support_for_heretic_ruler"
								duration = 1825
							}
						}
					}
				}
				clr_country_flag = small_effect
			}
			strong_effect = {
				if = {
					limit = { monthly_income = 30 }
					define_advisor = {
						type = theologian
						skill = 2
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				else = {
					define_advisor = {
						type = theologian
						skill = 1
						discount = yes
						religion = variable:new_ruler_religion
					}
				}
				random_owned_province = {
					limit = {
						has_owner_religion = yes
					}
					spawn_rebels = {
						type = religious_rebels
						size = 1
						leader = rebel_preacher
					}
				}
				custom_tooltip = culture_religion_events.2.c.ttl1
				hidden_effect = {
					every_owned_province = {
						limit = {
							has_owner_religion = yes
						}
						add_province_modifier = {
							name = "heretic_on_throne"
							duration = 4380
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							religion = variable:FROM:new_ruler_religion
						}
					}
					custom_tooltip = culture_religion_events.2.c.ttl2
					hidden_effect = {
						every_owned_province = {
							limit = {
								religion = variable:FROM:new_ruler_religion
							}
							add_province_modifier = {
								name = "support_for_heretic_ruler"
								duration = 4380
							}
						}
					}
				}
				clr_country_flag = strong_effect
			}
		}
	}
	option = {
		name = "culture_religion_events.2.dd" #Different Culture and Different Religion
		trigger = {
			has_regency = no
			NOT = { has_reform = mamluk_government }
			NOT = { ruler_culture = ROOT }
			NOT = { ruler_religion = ROOT }
		}
		if = {
			limit = {
				calc_true_if = {
					all_known_country = {
						OR = {
							religion = variable:From:new_ruler_religion
							primary_culture = variable:From:new_ruler_culture
						}
					}
					amount = 8
				}
			}
			custom_tooltip  = culture_and_religion_opinion_tooltip
			hidden_effect = {
				every_known_country = {
					limit = {
						religion = variable:From:new_ruler_religion
					}
					add_opinion = {
						modifier = opinion_ruler_of_our_religion
						who = ROOT
					}
				}
				every_known_country = {
					limit = {
						primary_culture = variable:From:new_ruler_culture
					}
					add_opinion = {
						modifier = opinion_ruler_of_our_culture
						who = ROOT
					}
				}
			}
		}
		else = {
			every_known_country = {
					limit = {
						religion = variable:From:new_ruler_religion
					}
					add_opinion = {
						modifier = opinion_ruler_of_our_religion
						who = ROOT
					}
				}
			every_known_country = {
				limit = {
					primary_culture = variable:From:new_ruler_culture
				}
				add_opinion = {
					modifier = opinion_ruler_of_our_culture
					who = ROOT
				}
			}
		}
		trigger_switch = {
			on_trigger = has_country_flag
			medium_effect = {
				custom_tooltip = culture_religion_events.2.dd.ttm
				if = {
					limit = {
						any_owned_province = {
							has_owner_religion = yes
							has_owner_culture = yes
						}
					}
					hidden_effect = {
						every_owned_province = {
							limit = {
								has_owner_religion = yes
								has_owner_culture = yes
							}
							add_province_modifier = {
								name = "alien_ruler"
								duration = 2555
							}
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							OR = {
								AND = {
									has_owner_religion = yes
									has_owner_culture = no
								}
								AND = {
									has_owner_religion = no
									has_owner_culture = yes
								}
							}
						}
					}
					hidden_effect = {
						every_owned_province = {
							limit = {
								OR = {
									AND = {
										has_owner_religion = yes
										has_owner_culture = no
									}
									AND = {
										has_owner_religion = no
										has_owner_culture = yes
									}
								}
							}
							add_province_modifier = {
								name = "alien_ruler"
								duration = 1825
							}
						}
					}
				}
				clr_country_flag = medium_effect
			}
			small_effect = {
				custom_tooltip = culture_religion_events.2.dd.tts
				if = {
					limit = {
						any_owned_province = {
							has_owner_religion = yes
							has_owner_culture = yes
						}
					}
					hidden_effect = {
						every_owned_province = {
							limit = {
								has_owner_religion = yes
								has_owner_culture = yes
							}
							add_province_modifier = {
								name = "alien_ruler"
								duration = 1825
							}
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							OR = {
								AND = {
									has_owner_religion = yes
									has_owner_culture = no
								}
								AND = {
									has_owner_religion = no
									has_owner_culture = yes
								}
							}
						}
					}
					hidden_effect = {
						every_owned_province = {
							limit = {
								OR = {
									AND = {
										has_owner_religion = yes
										has_owner_culture = no
									}
									AND = {
										has_owner_religion = no
										has_owner_culture = yes
									}
								}
							}
							add_province_modifier = {
								name = "alien_ruler"
								duration = 913
							}
						}
					}
				}
				clr_country_flag = small_effect
			}
			strong_effect = {
				custom_tooltip = culture_religion_events.2.dd.ttl
				if = {
					limit = {
						any_owned_province = {
							has_owner_religion = yes
							has_owner_culture = yes
						}
					}
					hidden_effect = {
						every_owned_province = {
							limit = {
								has_owner_religion = yes
								has_owner_culture = yes
							}
							add_province_modifier = {
								name = "alien_ruler"
								duration = 3650
							}
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							OR = {
								AND = {
									has_owner_religion = yes
									has_owner_culture = no
								}
								AND = {
									has_owner_religion = no
									has_owner_culture = yes
								}
							}
						}
					}
					hidden_effect = {
						every_owned_province = {
							limit = {
								OR = {
									AND = {
										has_owner_religion = yes
										has_owner_culture = no
									}
									AND = {
										has_owner_religion = no
										has_owner_culture = yes
									}
								}
							}
							add_province_modifier = {
								name = "alien_ruler"
								duration = 1825
							}
						}
					}
				}
				if = {
					limit = {
						any_owned_province = {
							is_state = yes
							OR = {
								has_owner_culture = yes
								has_owner_religion = yes
							}
						}
					}
					random_owned_province = {
						limit = {
							owner = { government = monarchy }
							is_state = yes
							OR = {
								has_owner_culture = yes
								has_owner_religion = yes
							}
						}
						spawn_rebels = {
							type = pretender_rebels
							size = 2
							leader = rebel_preacher
						}
					}
				}
				clr_country_flag = strong_effect
			}
		}
	}
	option = {
		name = "culture_religion_events.2.e"
		trigger = {
			OR = {
				has_regency = yes #It is also possible to enter a regency
				has_reform = mamluk_government #It is even possible to suddenly get the Mamluk Government form.
				AND = {
					ruler_culture = ROOT
					ruler_religion = ROOT
				}
			}
		}
		add_stability_or_adm_power = yes
		
	}
	
	after = {
		hidden_effect = {
			set_variable = {
				which = new_ruler_religion
				value = -1
			}
			set_variable = {
				which = new_ruler_culture
				value = -1
			}
			clear_saved_name = rebel_preacher
		}
	}
}

# Rising support among the [Root.other_advisor_culture.GetCultureName] Population
country_event = {
	id = culture_religion_events.11
	title = culture_religion_events.11.t
	desc = {
		trigger = {
			employed_advisor = {
				category = ADM
			}
			NOT = { primary_culture = new_variable:adm_advisor_culture }
			any_owned_province = {
				culture = new_variable:From:adm_advisor_culture
			}
		}
		desc = culture_religion_events.11.da
	}
	desc = {
		trigger = {
			OR = {
				NOT = {
					employed_advisor = {
						category = ADM
					}
				}
				primary_culture = new_variable:adm_advisor_culture
			}
			employed_advisor = {
				category = DIP
			}
			NOT = { primary_culture = new_variable:dip_advisor_culture }
			any_owned_province = {
				culture = new_variable:From:dip_advisor_culture
			}
		}
		desc = culture_religion_events.11.db
	}
	desc = {
		trigger = {
			OR = {
				NOT = {
					employed_advisor = {
						category = ADM
					}
				}
				primary_culture = new_variable:adm_advisor_culture
			}
			OR = {
				NOT = {
					employed_advisor = {
						category = DIP
					}
				}
				primary_culture = new_variable:dip_advisor_culture
			}
			employed_advisor = {
				category = MIL
			}
			NOT = { primary_culture = new_variable:mil_advisor_culture }
			any_owned_province = {
				culture = new_variable:From:mil_advisor_culture
			}
		}
		desc = culture_religion_events.11.dc
	}
	picture = {
		trigger = { NOT = { has_dlc = "Cradle of Civilization" } }
		picture = GOOD_WITH_MONARCH_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Cradle of Civilization" }
		picture = KING_OF_FOREIGN_CUSTOMS_eventPicture
	}
	
	is_triggered_only = yes

	trigger = {
		OR = { #Somewhere we have an advisor that will match.
			AND = {
				employed_advisor = {
					category = ADM
				}
				NOT = {
					employed_advisor = {
						category = ADM
						culture = ROOT
					}
				}
			}
			AND = {
				employed_advisor = {
					category = DIP
				}
				NOT = {
					employed_advisor = {
						category = DIP
						culture = ROOT
					}
				}
			}
			AND ={
				employed_advisor = {
					category = MIL
				}
				NOT = {
					employed_advisor = {
						category = MIL
						culture = ROOT
					}
				}
			}
		}
		if = { #ADM advisor is the one we want
			limit = {
				employed_advisor = { #We have an ADM Advisor
					category = ADM
				}
				NOT = {
					employed_advisor = { #His culture is not ours
						category = ADM
						culture = ROOT
					}
				}
			}
			any_owned_province = { #This is his home
				culture = new_variable:From:adm_advisor_culture
				NOT = { has_province_modifier = support_for_advisor } #event hasn't hit here before
			}
		}
		if = { #DIP advisor is the one we want
			limit = {
				OR = {
					NOT = {
						employed_advisor = {
							category = ADM
						}
					}
					employed_advisor = {
						category = ADM
						culture = ROOT
					}
				}
				employed_advisor = { #We do have a DIP advisor
					category = DIP
				}
				NOT = {
					employed_advisor = { #His culture is not ours
						category = DIP
						culture = ROOT
					}
				}
			}
			any_owned_province = { #This is his home
				culture = new_variable:From:dip_advisor_culture
				NOT = { has_province_modifier = support_for_advisor } #Event hasn't hit here before
			}
		}
		if = { #MIL advisor is the one we want
			limit = {
				OR = { #No matching adm advisor
					NOT = {
						employed_advisor = {
							category = ADM
						}
					}
					employed_advisor = {
						category = ADM
						culture = ROOT
					}
				}
				OR = { #No matching dip advisor
					NOT = {
						employed_advisor = {
							category = DIP
						}
					}
					employed_advisor = {
						category = DIP
						culture = ROOT
					}
				}
				employed_advisor = { #We do have a Mil advisor
					category = MIL
				}
				NOT = { 
					employed_advisor = { #His culture is not ours
						category = MIL
						culture = ROOT
					}
				}
			}
			any_owned_province = { #This is his home
				culture = new_variable:From:mil_advisor_culture
				NOT = { has_province_modifier = support_for_advisor } #Event hasn't hit here before
			}
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					employed_advisor = {
						category = ADM
					}
					NOT = {
						employed_advisor = {
							category = ADM
							culture = ROOT
						}
					}
					any_owned_province = {
						culture = new_variable:From:adm_advisor_culture
					}
				}
				export_to_variable = { #Primarily for localization
					variable_name = other_advisor_culture
					value = adm_advisor_culture
				}
			}
			else_if = {
				limit = {
					employed_advisor = {
						category = DIP
					}
					NOT = {
						employed_advisor = {
							category = DIP
							culture = ROOT
						}
					}
					any_owned_province = {
						culture = new_variable:From:dip_advisor_culture
					}
				}
				export_to_variable = { #Primarily for localization
					variable_name = other_advisor_culture
					value = dip_advisor_culture
				}
			}
			else = {
				export_to_variable = { #Primarily for localization
					variable_name = other_advisor_culture
					value = mil_advisor_culture
				}
			}
		}
	}
	
	option = {
		name = culture_religion_events.11.a #
		if = {
			limit = {
				calc_true_if = {
					all_owned_province = {
						culture = variable:From:other_advisor_culture
						NOT = { has_province_modifier = support_for_advisor }
					}
					amount = 6
				}
			}
			custom_tooltip = culture_religion_events.11.a.tt
			hidden_effect = {
				every_owned_province = {
					limit = {
						culture = variable:From:other_advisor_culture
						NOT = { has_province_modifier = support_for_advisor }
					}
					add_province_modifier = {
						name = support_for_advisor
						duration = 3650
					}
				}
			}
		}
		else = {
			every_owned_province = {
				limit = {
					culture = variable:From:other_advisor_culture
					NOT = { has_province_modifier = support_for_advisor }
				}
				add_province_modifier = {
					name = support_for_advisor
					duration = 3650
				}
			}
		}
	}
	after = {
		set_variable = {
			which = other_advisor_culture
			value = -1
		}
	}
}

#The [Root.other_advisor_religion.GetReligionName] Minister.
country_event = {
	id = culture_religion_events.12
	title = culture_religion_events.12.t
	desc = {
		trigger = {
			employed_advisor = {
				category = ADM
				religion = heretic
			}
		}
		desc = culture_religion_events.12.da
	}
	desc = {
		trigger = {
			NOT = {
				employed_advisor = {
					category = ADM
					religion = heretic
				}
			}
			employed_advisor = {
				category = DIP
				religion = heretic
			}
		}
		desc = culture_religion_events.12.db
	}
	desc = {
		trigger = {
			NOT = {
				employed_advisor = {
					category = ADM
					religion = heretic
				}
			}
			NOT = {
				employed_advisor = {
					category = DIP
					religion = heretic
				}
			}
			employed_advisor = {
				category = MIL
				religion = heretic
			}
		}
		desc = culture_religion_events.12.dc
	}
	picture = {
		trigger = { NOT = { has_dlc = "Cradle of Civilization" } }
		picture = GOOD_WITH_MONARCH_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Cradle of Civilization" }
		picture = KING_OF_FOREIGN_CUSTOMS_eventPicture
	}
	
	is_triggered_only = yes

	trigger = {
		employed_advisor = {
			religion = heretic
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					employed_advisor = {
						category = ADM
						religion = heretic
					}
				}
				export_to_variable = { #Primarily for localization
					variable_name = other_advisor_religion
					value = adm_advisor_religion
				}
				set_country_flag = adm_advisor_heretic
			}
			else_if = {
				limit = {
					NOT = {
						employed_advisor = {
							category = ADM
							religion = heretic
						}
					}
					employed_advisor = {
						category = DIP
						religion = heretic
					}
				}
				export_to_variable = { #Primarily for localization
					variable_name = other_advisor_religion
					value = dip_advisor_religion
				}
				set_country_flag = dip_advisor_heretic
			}
			else = {
				export_to_variable = { #Primarily for localization
					variable_name = other_advisor_religion
					value = mil_advisor_religion
				}
				set_country_flag = mil_advisor_heretic
			}
		}
	}
	
	option = {
		name = culture_religion_events.12.a #One day you might all rise to be like [Root.AdmAdvisor.GetName].
		trigger = { has_country_flag = adm_advisor_heretic }
		add_stability_or_adm_power = yes
	}
	option = {
		name = culture_religion_events.12.b #One day you might all rise to be like [Root.DipAdvisor.GetName].
		trigger = { has_country_flag = dip_advisor_heretic }
		add_stability_or_adm_power = yes
	}
	option = {
		name = culture_religion_events.12.c #One day you might all rise to be like [Root.MilAdvisor.GetName].
		trigger = { has_country_flag = mil_advisor_heretic }
		add_stability_or_adm_power = yes
	}
	after = {
		set_variable = {
			which = other_advisor_religion
			value = -1
		}
		trigger_switch = {
			on_trigger = has_country_flag
			adm_advisor_heretic = { clr_country_flag = adm_advisor_heretic }
			dip_advisor_heretic = { clr_country_flag = dip_advisor_heretic }
			mil_advisor_heretic = { clr_country_flag = mil_advisor_heretic }
		}
	}
}

# [Root.potential_heir_religion.GetReligionName] [Root.Heir.GetTitle]?
country_event = {
	id = culture_religion_events.20
	title = culture_religion_events.20.t
	desc = culture_religion_events.20.d
	picture = {
		trigger = { NOT = { has_dlc = "Cradle of Civilization" } }
		picture = BAD_WITH_MONARCH_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Cradle of Civilization" }
		picture = KING_OF_FOREIGN_CUSTOMS_eventPicture
	}
	
	is_triggered_only = yes

	trigger = {
		government = monarchy
		has_regency = no
		has_heir = no
		NOT = { has_reform = mamluk_government }
		has_government_attribute = heir
		any_owned_province = {
			has_owner_culture = no
		}
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_owner_culture = no
				}
				save_event_target_as = family_holdings
			}
			if = {
				limit = {
					any_country = {
						primary_culture = event_target:family_holdings
					}
				}
				set_saved_name = {
					key = young_heir
					type = advisor
					scope = event_target:good_name_list
				}
			}
			else = {
				set_saved_name = {
					key = young_heir
					type = advisor
					scope = ROOT
				}
			}
			set_heir_flag = legitimacy_questioned
		}
	}
	
	option = {
		name = culture_religion_events.20.a #A capital idea!
		define_heir = {
			age = 20
			name = young_heir
			dynasty = ROOT
			culture = event_target:family_holdings
			claim = 75
		}
	}
	option = {
		name = culture_religion_events.20.b #We will never see a [family_holdings.Culture.GetName] noble on our throne.
		add_legitimacy = 5
	}
	after = {
		clear_saved_name = young_heir
	}
}

# A Question of Faith
country_event = {
	id = culture_religion_events.21
	title = culture_religion_events.21.t
	desc = culture_religion_events.21.d
	picture = {
		trigger = { NOT = { has_dlc = "Cradle of Civilization" } }
		picture = BAD_WITH_MONARCH_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Cradle of Civilization" }
		picture = KING_OF_FOREIGN_CUSTOMS_eventPicture
	}
	
	is_triggered_only = yes

	trigger = {
		NOT = { has_ruler_flag = faith_question }
		government = monarchy
		NOT = { ruler_religion = ROOT }
		legitimacy = 90
		stability = 2
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			set_ruler_flag = faith_question
			export_to_variable = {
				variable_name = new_monarch_religion
				value = ruler_religion
			}
		}
	}
	
	option = {
		name = culture_religion_events.21.a #[Root.Capital.GetCapitalName] shall be a [Root.new_monarch_religion.GetReligionName] city.
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				dominant_religion = new_variable:ruler_religion
			}
		}
		change_religion = new_variable:ruler_religion
		add_stability = -4
		add_legitimacy = -30
	}
	option = {
		name = culture_religion_events.21.b #We could never take such a risk.
		ai_chance = {
			factor = 95
		}
		add_prestige = 10
	}
	after = {
		set_variable = {
			which = new_monarch_religion
			value = -1
		}
	}
}

# A Question of Culture
country_event = {
	id = culture_religion_events.22
	title = culture_religion_events.22.t
	desc = culture_religion_events.22.d
	picture = {
		trigger = { NOT = { has_dlc = "Cradle of Civilization" } }
		picture = BAD_WITH_MONARCH_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Cradle of Civilization" }
		picture = KING_OF_FOREIGN_CUSTOMS_eventPicture
	}
	
	is_triggered_only = yes

	trigger = {
		government = monarchy
		NOT = { ruler_culture = ROOT }
		heir_culture = new_variable:ruler_culture
		legitimacy = 90
		stability = 2
	}
	
	mean_time_to_happen = {
		days = 1
	}
	
	immediate = {
		hidden_effect = {
			set_ruler_flag = faith_question
			export_to_variable = {
				variable_name = new_monarch_culture
				value = ruler_culture
			}
		}
	}
	
	option = {
		name = culture_religion_events.22.a #
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				dominant_religion = new_variable:ruler_culture
			}
		}
		if = {
			limit = {
				NOT = { accepted_culture = new_variable:ruler_culture }
				NOT = { culture_group = new_variable:ruler_culture }
			}
			add_stability = -3
			add_legitimacy = -30
		}
		else = {
			add_stability = -2
			add_legitimacy = -15
		}
		change_primary_culture = new_variable:ruler_culture
	}
	option = {
		name = culture_religion_events.22.b #
		ai_chance = {
			factor = 95
		}
		add_prestige = 10
	}
	after = {
		set_variable = {
			which = new_monarch_culture
			value = -1
		}
	}
}